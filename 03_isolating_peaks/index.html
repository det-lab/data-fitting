
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../02_experiment_details/">
      
      
        <link rel="next" href="../04_fitting_curves/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.12">
    
    
      
        <title>Initial Plotting - Fitting Data</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.2afb09e1.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#initial-data-plotting" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Fitting Data" class="md-header__button md-logo" aria-label="Fitting Data" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Fitting Data
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Initial Plotting
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Fitting Data" class="md-nav__button md-logo" aria-label="Fitting Data" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Fitting Data
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../01_setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Setup
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../02_experiment_details/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Experiment
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Initial Plotting
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Initial Plotting
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#interpreting-the-plot" class="md-nav__link">
    <span class="md-ellipsis">
      Interpreting the Plot
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Interpreting the Plot">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#compton-scattering" class="md-nav__link">
    <span class="md-ellipsis">
      Compton Scattering
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../04_fitting_curves/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    First fits
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../05_linregress/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Line Fit
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../06_chi_squared/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chi Squared
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#interpreting-the-plot" class="md-nav__link">
    <span class="md-ellipsis">
      Interpreting the Plot
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Interpreting the Plot">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#compton-scattering" class="md-nav__link">
    <span class="md-ellipsis">
      Compton Scattering
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="initial-data-plotting">Initial Data Plotting</h1>
<p>For this section, let's first see the entire process for selecting out the data for a single file so that the method can be applied to all of our data. Just as an example, I'll be demonstrating the process using the <code>Co60.csv</code> file, which you may be able to guess contains a sample of Cobalt-60.</p>
<p>Before we can get started plotting our data, we'll want to import the modules which we will use. In the first cell of your Jupyter Notebook, add the import statements:</p>
<pre><code class="language-python">import pandas as pd
import matplotlib.pyplot as plt
import numpy as np
from scipy.optimize import curve_fit
from scipy.signal import find_peaks
from scipy.stats import linregress, chi2
</code></pre>
<p>Before plotting, we'll also want to inspect our <code>.csv</code> files to see which rows and columns we're able to use. Here's what the first several lines of the file <code>Co60.csv</code> contain:</p>
<p><img alt="Co60 data" src="../images/extra-data.png" /></p>
<p>As you can see here, rows 1 through 18 contain extraneous data related to the program settings when the data was collected, such as the voltage, fine and coarse grain values, the time and date that the data was collected, and so on. It isn't until row 23 that we start getting actual data points, with row 22 telling us the column names. We can also see that only the first and third columns (Channel &amp; Counts) contain data, with the second column (Energy) being empty. These facts hold true across all of our files, so we can skip the same initial rows and only use the same columns across all of our data.</p>
<p>For much of our data, it will also be easier to find our peaks if we set the y-axis to a logarithmic scale instead of a linear one. Let's get started by creating a method which will load and plot our data when given a file path, and which will also have an option to allow us to control how the y-axis is scaled:</p>
<pre><code class="language-python">def plot_data(isotope, y_log=True):
    data = pd.read_csv(f'raw-data/{isotope}.csv', skiprows=21, usecols=[0,2])
    # Assign axes and names
    x_axis = data.iloc[:,0]
    x_name = data.columns[0]

    y_axis = data.iloc[:,1]
    y_name = data.columns[1]

    # Create plot
    plt.scatter(x_axis, y_axis, s=1)
    plt.xlabel(x_name)
    plt.ylabel(y_name)
    plt.title(f&quot;{isotope} raw data&quot;)
    plt.savefig(f&quot;{isotope}_raw_data.png&quot;)
    if y_log:
        plt.yscale('log')
    plt.show()

    return data
</code></pre>
<p>This function only requires the name of the file before the file extension in order to create a plot of the recorded data. If <code>y_log</code> isn't specified, it will default to <code>True</code>:</p>
<pre><code class="language-python">plot_data(&quot;Co60&quot;, y_log=True)
</code></pre>
<p><strong>Output:</strong></p>
<p><img alt="Co60 Raw" src="../images/Co60_raw_data.png" /></p>
<h2 id="interpreting-the-plot">Interpreting the Plot</h2>
<p>In order to properly calibrate our data, it's necessary that we fully understand what the raw data is telling us. In this case, it's important to know first that Cobalt-60 has two peak emission spectra: one at <strong>1.175 MeV</strong>, and another at <strong>1.333 MeV</strong>. However, in this plot, there appear to be <strong>at least</strong> 3 separate peaks: 1 on the far left, and 2 on the far right of the plot, and 2 bumps which could possibly be considered peaks between them. So, how do we know which ones to consider when we begin isolating our peaks?</p>
<h3 id="compton-scattering">Compton Scattering</h3>
<p>In gamma spectroscopy, not every gamma photon deposits its full energy into the detector. As mentioned previously, the scintillator steps down the photon energies in a process known as <strong>Compton scattering</strong>, where a photon transfers its energy to a series of electrons. In this process, it is possible for only a fraction of the photon's energy to be absorbed by the electron it's incident upon, with the total deposited energy being reliant on the scattering angle. Between the leftmost and rightmost peaks in the plot, you can see a gently sloping distribution. This is known as the <strong>Compton plateau</strong> or <strong>Compton continuum</strong>.</p>
<p>The upper limit of partial energy deposition forms what's called the <strong>Compton edge</strong> (or <strong>Compton cliff</strong>): a relatively sharp drop at the high-energy end of the Compton continuum. In the plot for Cobalt-60, this can be seen just before the peaks on the right hand side. The energy of this edge corresponds to the maximum energy that a photon can transfer in a single Compton scattering event, which occurs when the photon enters the detector and deposits a significant portion of its energy before being reflected <span class="arithmatex">\(180^\circ\)</span>. The smaller "bumps" before the main peaks are not true photopeaks, but part of the Compton scattering pattern.</p>
<p>The <strong>far-left</strong> peak is most likely the result of backscatter radiation. Backscatter peaks arise when gamma photons scatter off of nearby objects, such as walls, the table, or the radiation shielding, before they re-enter the detector with significantly reduced energy. These photons can produce a small but distinct peak at lower channels, below the main Compton continuum. </p>
<p>It is also possible for the lower energy peaks to occur as a result of the detector material. When an incoming gamma photon ejects an inner shell electron in the scintillator, it will emit a characteristic X-ray depending on what it's made out of, NaI in the case of this experiment. This is called an X-ray escape peak. </p>
<p>This gives our low energy peak two possible explanations: either it is backscatter radiation, or it is an escape peak emitted by our NaI detector. These explanations don't have to be mutually exclusive either - it's possible that both features occur with similar energies.</p>
<p>It's important to understand that the Compton edge only shows the maximum for <strong>partial energy loss</strong>, not the <strong>maximum possible energy</strong> that can be detected. Past the edge, a photon gets closer to being fully absorbed by the scintillator, meaning everything before the furthest right peaks represents events where the photon is at least partially reflected out of the detector, and the centers of the peaks represent where most or all of the photon's energy is absorbed by the scintillator and passed on to the PMT. Every true photopeak should be preceded by a Compton continuum and edge. As our photopeaks are so near each other in our Co-60 data, their respective Compton features overlap.</p>
<p>Altogether, this plot shows:</p>
<ul>
<li>
<p>A backscatter reflective peak and/or an X-ray escape peak on the far left,</p>
</li>
<li>
<p>A Compton continuum in the mid range,</p>
</li>
<li>
<p>A Compton edge before the first photopeak,</p>
</li>
<li>
<p>And finally, the two true photopeaks of Cobalt-60 on the far right.</p>
</li>
</ul>
<p>Now that we understand the features of our plot, let's move forward to selecting the data from our peaks.</p>
<h1 id="selecting-the-photopeaks">Selecting the Photopeaks</h1>
<p>There are two main methods that can be used to find our peaks: </p>
<ol>
<li>
<p>Using the <code>find_peaks</code> module in <code>scipy</code></p>
</li>
<li>
<p>Visually inspecting the data.</p>
</li>
</ol>
<p>Before attempting either of these methods, let's edit our <code>plot_data</code> function to return the <code>data</code> variable so that it can be saved and used elsewhere. At the end of the function, simply add <code>return data</code>. Then, when you call the function, you can set <code>data</code> to a new variable, turning our function call into:</p>
<pre><code class="language-python">Co_60 = plot_data(&quot;Co60.csv&quot;, y_log=True)
</code></pre>
<p>Now we can use the <code>Co_60</code> variable to find our peaks. Let's look at the process for using <code>find_peaks</code> first.</p>
<h2 id="find_peaks"><code>find_peaks</code></h2>
<p>In order to find our peaks with this method, we'll first want to assign  <code>Co_60</code>'s x- and y-axes to variables so that we can plot them against what <code>find_peaks</code> returns as a comparison. The result that we're looking for is to have one selected point at the top of our two right peaks.</p>
<p>The <code>find_peaks</code> module can take as optional parameters: <code>height</code>, <code>threshold</code>, <code>distance</code>, <code>prominence</code>, <code>width</code>, <code>wlen</code>, <code>rel_height</code>, and <code>plateu_size</code>. Locating the peaks will require careful manipulation of these values in order to exclude noise and data that isn't the peaks. For more complete descriptions of these parameters, <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.find_peaks.html">click here to go to the official documentation.</a></p>
<p>Without assigning any of these parameters a value, <code>find_peaks</code> selects indices in the data that are preceded by and followed by smaller values. It returns them along with a dictionary which contains the values <strong>it calculates</strong> for the optional parameters (heights, thresholds, prominences, etc). To show what this looks like, let's plot our data underneath the found peaks without first trying to filter for certain parameters:</p>
<pre><code class="language-python">x_values = Co_60.iloc[:,0]
y_values = Co_60.iloc[:,1]
# Find peaks
peaks, _ = find_peaks(y_values)
# Plot data
plt.scatter(x_values, y_values, s=1)
# Plot peaks
plt.plot(peaks, y_values[peaks], 'x', color='red')
plt.show()
</code></pre>
<p><strong>Output:</strong></p>
<p><img alt="first peak find" src="../images/first_peak_find.png" /></p>
<p>Each one of the plotted 'x's here is being counted as another individual 'peak'. So, to narrow down our choices, let's start trying to estimate the parameters. Let's try adjusting <code>distance</code>, <code>prominence</code>, and <code>width</code>. The distance argument sets the minimum distance that should exist between two peaks. The <code>prominence</code> argument measures the vertical distance between the top of the peak and the lowest contour line that doesn't enclose a higher peak (as opposed to <code>height</code> which measures the distance from the top of the peak to y=0). The width argument measures the horizontal span of a single peak. If we provide an estimate for these values at <code>150</code>, <code>100</code>, and <code>60</code> respectively, we'll be able to select out the two peaks we want:</p>
<pre><code class="language-python">x_values = Co_60.iloc[:,0]
y_values = Co_60.iloc[:,1]
peaks, _ = find_peaks(y_values, distance=150, prominence=100, width=60)
plt.plot(x_values, y_values)
plt.plot(peaks, y_values[peaks], 'x', color='red')
plt.show()
</code></pre>
<p><strong>Output:</strong></p>
<p><img alt="filtered peaks" src="../images/filtered_peaks.png" /></p>
<p>Now, we'll have to save the data around the peaks. This can be done with a <code>for loop</code> where we select a number of points on either side of the peak, extract that portion of the dataset, and store it for later use. We'll also include safeguards to ensure we don't go outside of the bounds of the data:</p>
<pre><code class="language-python">peak_ranges = []
for peak in peaks:
    left=max(0, peak-60)
    right=min(len(y_values)-1, peak + 60)
    peak_ranges.append(Co_60.iloc[left:right].copy())
</code></pre>
<p>Each entry in <code>peak_ranges</code> now holds a slice of copied data centered around one of the detected peaks. We can plot each of these slices to visually confirm that the correct regions were captured:</p>
<pre><code class="language-python">for peak in peak_ranges:
    plt.scatter(peak.iloc[:,0], peak.iloc[:,1], s=1)
plt.title('Isolated peaks')
plt.xlabel('Channels')
plt.ylabel('Counts')
plt.show()
</code></pre>
<p><strong>Output:</strong></p>
<p><img alt="found peaks" src="../images/find_peaks_finished.png" /></p>
<p>This also highlights one of the shortcomings of the <code>find_peaks</code> function. As we can see with the peak on the left, our selection won't necessarily be centered. It found the highest point in the left peak, which happens to be an outlier in the data, and assumes that this point is the center of the peak.</p>
<p>You could then set each peak to a new variable so that it can be used in the next section by using:</p>
<pre><code class="language-python">Co_60P1 = peak_ranges[0]
Co_60P2 = peak_ranges[1]
</code></pre>
<p>While <code>find_peaks</code> is generally very powerful, it requires careful tuning of multiple parameters. It is also possible to run into plots where the peaks that you see can't easily be distinguished from noise using this module, or where it is impossible to set the parameters so as to include all peaks, such as when two peaks overlap with each other while others are distinct. There are work arounds for these issues, such as running it multiple times to select peaks with different parameters in the same data, but it may be better to use another method for isolating your peaks depending on which problems you're running into.</p>
<h2 id="visual-inspection">Visual inspection</h2>
<p>While it may not be programmatically optimized, one of the easier ways to isolate peaks is by eye: simply estimate where the boundaries of the peaks are and use those numbers to splice the plot. If it's off - adjust your numbers until the peaks are as close to centered as you can get them. If you plot your estimates as you go, you will also be contracting what's shown of the x-axis, providing you with new tick marks with less distance between them, allowing you to splice more accurately.</p>
<p>Let's try:</p>
<pre><code class="language-python">Co_60P1 = Co_60.iloc[1600:1900].copy()
plt.scatter(co_peak_one.columns[0], co_peak_one.columns[1], s=1)
plt.show()
</code></pre>
<p><strong>Output:</strong></p>
<p><img alt="peak one est" src="../images/CoPeak1_1.png" /></p>
<p>This isn't perfect, but makes it easier to find the appropriate limits. To center the peak, let's use the data range [1680:1815]:</p>
<p><img alt="peak one centered" src="../images/CoPeak1_2.png" /></p>
<p>Nice! Now we can use the same process to isolate our second peak, giving us:</p>
<pre><code class="language-python">Co_60P2 = Co_60.iloc[1850:2025].copy()
plt.scatter(Co_60P2.iloc[:,0], Co_60P2.iloc[:,1], s=1)
plt.show()
</code></pre>
<p><strong>Output:</strong></p>
<p><img alt="peak two" src="../images/CoPeak2_1.png" /></p>
<hr />
<p>Now that we have our first peaks isolated, <a href="../04_fitting_curves/">click here to continue on to the next section</a> where we'll learn how to fit our data to an equation.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>