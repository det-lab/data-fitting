
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../05_linregress/">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.12">
    
    
      
        <title>Chi Squared - Fitting Data</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.2afb09e1.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#what-is-a-chi2-fit" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Fitting Data" class="md-header__button md-logo" aria-label="Fitting Data" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Fitting Data
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Chi Squared
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Fitting Data" class="md-nav__button md-logo" aria-label="Fitting Data" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Fitting Data
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../01_setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Setup
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../02_experiment_details/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Experiment
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../03_isolating_peaks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Initial Plotting
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../04_fitting_curves/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    First fits
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../05_linregress/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Line Fit
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Chi Squared
    
  </span>
  

      </a>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="what-is-a-chi2-fit">What is a <span class="arithmatex">\(\chi^2\)</span> Fit?</h1>
<p>A <span class="arithmatex">\(\chi^2\)</span> (or <strong>chi-squared</strong>/<strong>weighted least squares</strong> fit) is a way of fitting a model to data when each point has a different uncertainty. </p>
<p>If your data points are <span class="arithmatex">\((O_i, C_i)\)</span>, (where O is your <strong>Observation</strong> data, and C is your <strong>Calculated</strong> or expected data) and each <span class="arithmatex">\(O_i\)</span> has an uncertainty <span class="arithmatex">\(\sigma_i\)</span>, then the best-fit line <strong>minimizes</strong> the quantity:</p>
<div class="arithmatex">\[\chi^2 = \sum_{i}(\frac{O_i - C_i}{\sigma_i})^2\]</div>
<h1 id="why-use-a-chi2-test">Why Use a <span class="arithmatex">\(\chi^2\)</span> Test?</h1>
<p>Now that we've predicted the emission energies of the unknown peaks and identified possible isotopic matches using gamma emission tables, we need a way to quantify how well each candidate matches our observations. This is where the <span class="arithmatex">\(\chi^2\)</span> test becomes valuable. We are able to run the test by setting <span class="arithmatex">\(O_i\)</span> as the measured energy from the sample, <span class="arithmatex">\(C_i\)</span> as the known emission energy from the candidates, and <span class="arithmatex">\(\sigma_i\)</span> as the uncertainty in <span class="arithmatex">\(O_i\)</span>. This means that we are performing a weighted fit: the smaller an observations uncertainty, the more it will matter for determining the quality of the fit.</p>
<p>For each combination of candidate isotopes, we'll compute the total chi-squared value. Once we calculate <span class="arithmatex">\(\chi^2\)</span>, we can then also calculate the <strong>reduced chi-squared</strong> statistic. This lets us move beyond eyeballing the tables and actually rank our findings based on how statistically compatible they are with the observed data.:</p>
<div class="arithmatex">\[\chi^2_{red}=\frac{\chi^2}{\nu}=\frac{\chi^2}{N-p}\]</div>
<p>Where:</p>
<ul>
<li>
<p><span class="arithmatex">\(N\)</span> is the number of data points</p>
</li>
<li>
<p><span class="arithmatex">\(p\)</span> is the number of fitted parameters</p>
</li>
<li>
<p><span class="arithmatex">\(\nu\)</span> is the <strong>degrees of freedom</strong></p>
</li>
</ul>
<p>We'll perform a <span class="arithmatex">\(\chi^2\)</span> calculation for each possible <strong>pairing</strong> between a peak-1 candidate and a peak-2 candidate. The closer <span class="arithmatex">\(\chi^2_{red}\)</span> is to 1, the better the match. Large values indicate a poor match, while very small values might suggest that our uncertainties are too large or that the candidate is suspiciously good. For each of our possible 6 pairs, we'll compare their known emission energies to our observed values. So, for each pair we will compute:</p>
<div class="arithmatex">\[\chi^2 = (\frac{E_{obs,1}-E_{cand,1}}{\sigma_1})^2 + (\frac{E_{obs,2}-E_{cand,2}}{\sigma_2})^2\]</div>
<p>Because we're not fitting any parameters, only testing two fixed candidate emission energies, the degrees of freedom, <span class="arithmatex">\(\nu\)</span>, is simply 2, giving us:</p>
<div class="arithmatex">\[\chi^2_{red}=\frac{\chi^2}{2}\]</div>
<h1 id="implementing-the-chi2-calculation">Implementing the <span class="arithmatex">\(\chi^2\)</span> calculation</h1>
<p>The first thing that we'll want to do is place our candidate isotopes into arrays so that we can later use nested <code>for loops</code> to compare them all against each other:</p>
<pre><code class="language-python">peak_one = [
    ('Pm-144', 696.490),
    ('Nb-94', 702.622)
]

peak_two = [
    ('Sn-123', 1088.64),
    ('Te-121', 1102.15),
    ('Zn-65', 1115.55)
]
</code></pre>
<p>We'll also want to place our predicted energies and their respective uncertainties into a similar array for this:</p>
<pre><code class="language-python">unknown_energies = [
    (predicted_energies[0], predicted_uncertainty[0]),
    (predicted_energies[1], predicted_uncertainty[1])
]
</code></pre>
<p>Next, we can create a function which takes these arrays as inputs and returns which combination of isotopes is our best fit. Before the nested <code>for loop</code> mentioned, we'll want to create an empty array which we can fill with our results. Then, for each choice in <code>peak_one</code>, we'll go through each option in <code>peak_two</code> and select the observed/predicted energies, their uncertainties, and the candidate energies, loading them all into separate arrays which we can then use to calculate <span class="arithmatex">\(\chi^2\)</span>. We'll load the results into the results array, and then when the loop is completed we will sort it by <span class="arithmatex">\(\chi^2_{red}\)</span>. Then we can run this function and print out the results!</p>
<pre><code class="language-python">def find_best_isotope_pair(unknown_energies, peak_one, peak_two):
    results = []
    for peak1_isotope, peak1_energy in peak_one:
        for peak2_isotope, peak2_energy in peak_two:
            observed = np.array([unknown_energies[0][0], unknown_energies[1][0]])
            uncertainty = np.array([unknown_energies[0][1], unknown_energies[1][1]])
            expected = np.array([peak1_energy, peak2_energy])

            residuals = (observed - expected) / uncertainty
            chi2 = float(np.sum(residuals**2))
            chi2_reduced = chi2 / len(observed)

            results.append((
                (peak1_isotope, peak2_isotope),
                (peak1_energy, peak2_energy),
                chi2,
                chi2_reduced
            ))
    results.sort(key=lambda x: abs(x[3]-1))
    return results

results = find_best_isotope_pair(unknown_energies, peak_one, peak_two)
print(f'Best fit pair: {results[0][0]}, chi-squared reduced: {results[0][3]}')
print(f'Worst fit pair: {results[-1][0]}, chi-squared reduced: {results[-1][3]}')
</code></pre>
<p><strong>Output:</strong></p>
<pre><code class="language-python">Best fit pair: ('Nb-94', 'Zn-65'), chi-squared reduced: 0.72
Worst fit pair: ('Pm-144', 'Te-121'), chi-squared reduced: 0.11
</code></pre>
<h1 id="conclusion">Conclusion</h1>
<p>In this lesson, we've explored the fundamentals of data fitting. Data fitting is a crucial tool in scientific computation that allows us to extract meaningful patterns, validate hypotheses, and quantify uncertainties in experimental data. Whether you're comparing theory to experiment, identifying trends, or modeling physical systems, fitting lets you move from raw data to interpretable results.</p>
<p>We introduced two powerful fitting methods in Python: <code>linregress</code>, a quick and simple tool for linear fits, and <code>curve_fit</code>, a more flexible option for fitting arbitrary functions to data. We also discussed the importance of weighting data points based on their uncertainties, which led us to the reduced <span class="arithmatex">\(\chi^2\)</span> test. By applying this test, we demonstrated how to judge our fits using statistical evidence. </p>
<p>Altogether, you've now seen how Python tools and statistical reasoning can come together to support robust data analysis. As your datasets grow more complex, these skills will form a foundation for more advanced modeling, error propagation, and hypothesis testing.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>